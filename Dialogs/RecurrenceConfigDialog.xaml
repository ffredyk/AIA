<ui:FluentWindow x:Class="AIA.Dialogs.RecurrenceConfigDialog"
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                xmlns:local="clr-namespace:AIA"
                Title="{local:Localize Tasks_ConfigureRecurrence}"
                Width="500" Height="450"
                WindowStartupLocation="CenterOwner"
                Background="{ui:ThemeResource ApplicationBackgroundBrush}">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" Text="{local:Localize Tasks_RecurrenceSettings}" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,20"/>
        
        <!-- Settings -->
        <StackPanel Grid.Row="1">
            <!-- Enable Recurrence -->
            <CheckBox x:Name="ChkEnableRecurrence" Content="{local:Localize Tasks_EnableRecurrence}" 
                     FontSize="14" Margin="0,0,0,20" Checked="ChkEnableRecurrence_Changed" Unchecked="ChkEnableRecurrence_Changed"/>
            
            <!-- Recurrence Type -->
            <TextBlock Text="{local:Localize Tasks_RecurrenceType}" FontSize="11" Margin="0,0,0,4"/>
            <ComboBox x:Name="CmbRecurrenceType" Margin="0,0,0,16" Background="{ui:ThemeResource ControlFillColorDefaultBrush}"
                     IsEnabled="{Binding IsChecked, ElementName=ChkEnableRecurrence}">
                <ComboBoxItem Content="{local:Localize RecurrenceType_Daily}" Tag="Daily"/>
                <ComboBoxItem Content="{local:Localize RecurrenceType_Weekly}" Tag="Weekly"/>
                <ComboBoxItem Content="{local:Localize RecurrenceType_Monthly}" Tag="Monthly"/>
                <ComboBoxItem Content="{local:Localize RecurrenceType_Yearly}" Tag="Yearly"/>
            </ComboBox>
            
            <!-- Interval -->
            <TextBlock Text="{local:Localize Tasks_Repeat}" FontSize="11" Margin="0,0,0,4"/>
            <Grid Margin="0,0,0,16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="{local:Localize Tasks_Every}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <ui:NumberBox Grid.Column="1" x:Name="NumInterval" Value="1" Minimum="1" Maximum="365"
                             Background="{ui:ThemeResource ControlFillColorDefaultBrush}"
                             IsEnabled="{Binding IsChecked, ElementName=ChkEnableRecurrence}"/>
                <TextBlock Grid.Column="2" x:Name="TxtIntervalUnit" Text="{local:Localize RecurrenceUnit_Days}" 
                          VerticalAlignment="Center" Margin="8,0,0,0"/>
            </Grid>
            
            <!-- End Date -->
            <CheckBox x:Name="ChkSetEndDate" Content="{local:Localize Tasks_SetEndDate}" Margin="0,0,0,8"
                     IsEnabled="{Binding IsChecked, ElementName=ChkEnableRecurrence}"/>
            <DatePicker x:Name="DateEndDate" Margin="0,0,0,16" Background="{ui:ThemeResource ControlFillColorDefaultBrush}"
                       IsEnabled="{Binding IsChecked, ElementName=ChkSetEndDate}"/>
            
            <!-- Preview -->
            <Border Background="{ui:ThemeResource ControlFillColorDefaultBrush}" CornerRadius="6" Padding="12" Margin="0,8,0,0">
                <StackPanel>
                    <TextBlock Text="{local:Localize Tasks_RecurrencePreview}" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <TextBlock x:Name="TxtPreview" TextWrapping="Wrap" FontSize="12"/>
                </StackPanel>
            </Border>
        </StackPanel>
        
        <!-- Action Buttons -->
        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <ui:Button Grid.Column="1" Content="{local:Localize Common_OK}" Appearance="Primary" Click="BtnOK" Padding="24,8" Margin="0,0,8,0"/>
            <ui:Button Grid.Column="2" Content="{local:Localize Common_Cancel}" Click="BtnCancel" Padding="24,8"/>
        </Grid>
    </Grid>
</ui:FluentWindow>
