<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                    xmlns:outlook="clr-namespace:AIA.Plugins.Outlook"
                    xmlns:teams="clr-namespace:AIA.Plugins.Teams">

    <!-- Outlook Plugin Tab Template -->
    <DataTemplate x:Key="OutlookTabTemplate" DataType="{x:Type outlook:OutlookTabViewModel}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="300"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*" MinWidth="400"/>
            </Grid.ColumnDefinitions>
            
            <!-- Flagged Emails List Panel -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header with Refresh -->
                <Grid Margin="8,8,8,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Flagged Emails" Foreground="White" FontWeight="SemiBold" FontSize="13"/>
                        <TextBlock Text="{Binding StatusMessage}" Foreground="#999999" FontSize="11" Margin="0,2,0,0"/>
                    </StackPanel>
                    <ui:Button Grid.Column="1" Padding="6,4" Background="Transparent" 
                               Command="{Binding RefreshCommand}" IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBool}}">
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Symbol="ArrowSync12" Foreground="White" FontSize="12"/>
                            <TextBlock Margin="4,0,0,0" Text="Refresh" Foreground="White" FontSize="11"/>
                        </StackPanel>
                    </ui:Button>
                </Grid>
                
                <!-- Loading Indicator -->
                <Border Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}">
                    <StackPanel>
                        <ui:SymbolIcon Symbol="ArrowSync20" FontSize="32" Foreground="#666666"/>
                        <TextBlock Text="Loading emails..." Foreground="#666666" FontSize="12" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
                
                <!-- Outlook Not Available -->
                <StackPanel Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center"
                            Visibility="{Binding IsAvailable, Converter={StaticResource InverseBoolToVis}}">
                    <ui:SymbolIcon Symbol="MailDismiss20" FontSize="48" Foreground="#666666"/>
                    <TextBlock Text="Outlook not available" Foreground="#666666" FontSize="14" Margin="0,12,0,0" HorizontalAlignment="Center"/>
                    <TextBlock Text="Make sure Microsoft Outlook is installed" Foreground="#555555" FontSize="11" Margin="0,4,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
                
                <!-- Emails List -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="8,0,8,8"
                              Visibility="{Binding IsAvailable, Converter={StaticResource BoolToVis}}">
                    <ItemsControl ItemsSource="{Binding FlaggedEmails}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="0,4" CornerRadius="8" BorderBrush="#33FFFFFF" BorderThickness="1"
                                        Cursor="Hand" Background="#0CFFFFFF">
                                    <Grid Margin="10,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Flag Icon -->
                                        <ui:SymbolIcon Symbol="Flag16" Foreground="#FF4444" FontSize="16" 
                                                       VerticalAlignment="Top" Margin="0,4,10,0"/>
                                        
                                        <!-- Email Info -->
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding Subject}" FontWeight="SemiBold" Foreground="White" FontSize="13" TextTrimming="CharacterEllipsis"/>
                                            <TextBlock Text="{Binding SenderName}" Foreground="#CCCCCC" FontSize="12" Margin="0,2,0,0" TextTrimming="CharacterEllipsis"/>
                                            <TextBlock Text="{Binding BodyPreview}" Foreground="#888888" FontSize="11" Margin="0,2,0,0" TextTrimming="CharacterEllipsis"/>
                                        </StackPanel>
                                        
                                        <!-- Time Info -->
                                        <StackPanel Grid.Column="2" VerticalAlignment="Top" Margin="8,0" HorizontalAlignment="Right">
                                            <TextBlock Text="{Binding ReceivedDateText}" Foreground="#999999" FontSize="10" HorizontalAlignment="Right"/>
                                            <TextBlock Text="{Binding FlagDueDateText}" FontSize="10" Margin="0,4,0,0" HorizontalAlignment="Right" Foreground="#999999"/>
                                        </StackPanel>
                                        
                                        <!-- Complete Button -->
                                        <ui:Button Grid.Column="3" Padding="4" Background="Transparent" ToolTip="Mark as complete">
                                            <ui:SymbolIcon Symbol="CheckmarkCircle12" Foreground="#1EB75F" FontSize="14"/>
                                        </ui:Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        
            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="4" Background="#33FFFFFF" HorizontalAlignment="Center" VerticalAlignment="Stretch"/>
            
            <!-- Email Details Panel -->
            <Border Grid.Column="2" Margin="8" CornerRadius="8" Background="#0CFFFFFF" BorderBrush="#33FFFFFF" BorderThickness="1">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center"
                            Visibility="{Binding HasSelectedEmail, Converter={StaticResource InverseBoolToVis}}">
                    <ui:SymbolIcon Symbol="Mail20" FontSize="48" Foreground="#666666"/>
                    <TextBlock Text="Select an email to view details" Foreground="#666666" Margin="0,12,0,0" FontSize="14"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Teams Plugin Tab Template -->
    <DataTemplate x:Key="TeamsTabTemplate" DataType="{x:Type teams:TeamsTabViewModel}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="300"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*" MinWidth="400"/>
            </Grid.ColumnDefinitions>
            
            <!-- Meetings & Messages List -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header -->
                <Grid Margin="8,8,8,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Teams" Foreground="White" FontWeight="SemiBold" FontSize="13"/>
                        <TextBlock Text="{Binding StatusMessage}" Foreground="#999999" FontSize="11" Margin="0,2,0,0"/>
                    </StackPanel>
                    <ui:Button Grid.Column="1" Padding="6,4" Background="Transparent" Margin="0,0,4,0"
                               IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBool}}">
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Symbol="ArrowSync12" Foreground="White" FontSize="12"/>
                            <TextBlock Margin="4,0,0,0" Text="Refresh" Foreground="White" FontSize="11"/>
                        </StackPanel>
                    </ui:Button>
                    <ui:Button Grid.Column="2" Padding="6,4" Background="#335B5FC7">
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Symbol="Open12" Foreground="White" FontSize="12"/>
                            <TextBlock Margin="4,0,0,0" Text="Open Teams" Foreground="White" FontSize="11"/>
                        </StackPanel>
                    </ui:Button>
                </Grid>
                
                <!-- Loading Indicator -->
                <Border Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}">
                    <StackPanel>
                        <ui:SymbolIcon Symbol="ArrowSync20" FontSize="32" Foreground="#666666"/>
                        <TextBlock Text="Loading Teams data..." Foreground="#666666" FontSize="12" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
                
                <!-- Content -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="8,0,8,8"
                              Visibility="{Binding IsAvailable, Converter={StaticResource BoolToVis}}">
                    <StackPanel>
                        <!-- Today's Meetings -->
                        <TextBlock Text="Today's Meetings" Foreground="#AAAAAA" FontSize="11" FontWeight="SemiBold" Margin="0,8,0,4"/>
                        <ItemsControl ItemsSource="{Binding TodaysMeetings}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,4" CornerRadius="8" Background="#0CFFFFFF" Cursor="Hand">
                                        <Grid Margin="10,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <ui:SymbolIcon Symbol="CalendarLtr20" Foreground="#5B5FC7" FontSize="20" VerticalAlignment="Top" Margin="0,2,10,0"/>
                                            
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="{Binding Subject}" FontWeight="SemiBold" Foreground="White" FontSize="13" TextTrimming="CharacterEllipsis"/>
                                                <TextBlock Text="{Binding TimeRange}" Foreground="#AAAAAA" FontSize="11" Margin="0,2,0,0"/>
                                                <TextBlock Text="{Binding Organizer}" Foreground="#888888" FontSize="11"/>
                                            </StackPanel>
                                            
                                            <ui:Button Grid.Column="2" Padding="6,4" Background="#335B5FC7" 
                                                       Visibility="{Binding CanJoin, Converter={StaticResource BoolToVis}}">
                                                <StackPanel Orientation="Horizontal">
                                                    <ui:SymbolIcon Symbol="Video16" Foreground="White" FontSize="12"/>
                                                    <TextBlock Margin="4,0,0,0" Text="Join" Foreground="White" FontSize="11"/>
                                                </StackPanel>
                                            </ui:Button>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        
                        <!-- Messages -->
                        <TextBlock Text="Unread Messages" Foreground="#AAAAAA" FontSize="11" FontWeight="SemiBold" Margin="0,16,0,4"/>
                        <ItemsControl ItemsSource="{Binding UnreadMessages}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,4" CornerRadius="8" Background="#0CFFFFFF" Cursor="Hand">
                                        <Grid Margin="10,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <ui:SymbolIcon Symbol="Chat20" Foreground="#5B5FC7" FontSize="20" VerticalAlignment="Top" Margin="0,2,10,0"/>
                                            
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="{Binding SenderName}" FontWeight="SemiBold" Foreground="White" FontSize="13"/>
                                                <TextBlock Text="{Binding ContentPreview}" Foreground="#AAAAAA" FontSize="11" Margin="0,2,0,0" TextTrimming="CharacterEllipsis"/>
                                                <TextBlock Text="{Binding SourceName}" Foreground="#888888" FontSize="10"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Column="2" Text="{Binding ReceivedDateText}" Foreground="#666666" FontSize="10" VerticalAlignment="Top"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
            
            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="4" Background="#33FFFFFF" HorizontalAlignment="Center" VerticalAlignment="Stretch"/>
            
            <!-- Details Panel -->
            <Border Grid.Column="2" Margin="8" CornerRadius="8" Background="#0CFFFFFF" BorderBrush="#33FFFFFF" BorderThickness="1">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <ui:SymbolIcon Symbol="PeopleTeam20" FontSize="48" Foreground="#666666"/>
                    <TextBlock Text="Select an item to view details" Foreground="#666666" Margin="0,12,0,0" FontSize="14"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>

</ResourceDictionary>
